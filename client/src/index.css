@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply font-sans antialiased bg-background text-foreground;
  }

  /* Android keyboard optimization */
  html {
    height: 100%;
    overflow: hidden;
  }
  
  body {
    height: 100%;
    overflow: hidden;
    position: fixed;
    width: 100%;
  }
  
  #root {
    height: calc(var(--vh, 1vh) * 100);
    overflow: hidden;
  }
  
  /* Prevent viewport shift on mobile keyboard */
  @supports (-webkit-touch-callout: none) {
    html {
      height: -webkit-fill-available;
    }
    
    body {
      height: -webkit-fill-available;
    }
    
    #root {
      height: -webkit-fill-available;
    }
  }
  
  /* Mobile textarea optimization */
  textarea {
    resize: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
  }
  
  /* Prevent zoom on input focus for mobile */
  @media screen and (max-width: 768px) {
    input[type="text"], 
    input[type="number"], 
    input[type="email"], 
    input[type="password"],
    textarea {
      font-size: 16px;
      -webkit-user-select: text;
      user-select: text;
    }
  }
  
  /* Mobile keyboard handling for floating components */
  @media screen and (max-width: 768px) {
    .floating-sheet-mobile {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      width: 100% !important;
      height: calc(var(--vh, 1vh) * 100) !important;
      max-height: calc(var(--vh, 1vh) * 100) !important;
      border-radius: 0 !important;
      z-index: 9999 !important;
    }
    
    .floating-sheet-mobile .scrollable-content {
      height: calc(var(--vh, 1vh) * 100 - 60px) !important;
      overflow-y: auto !important;
      -webkit-overflow-scrolling: touch;
    }
  }
  
  /* Keyboard adaptation for Android */
  @supports (height: 100dvh) {
    @media screen and (max-width: 768px) {
      .floating-sheet-mobile {
        height: 100dvh !important;
        max-height: 100dvh !important;
      }
      
      .floating-sheet-mobile .scrollable-content {
        height: calc(100dvh - 60px) !important;
      }
    }
  }
  
  /* Specific Android keyboard fixes */
  @media screen and (max-width: 768px) {
    /* Prevent content jump when keyboard opens */
    .floating-sheet-mobile {
      transform: translateZ(0);
      -webkit-transform: translateZ(0);
      will-change: transform;
    }
    
    /* Ensure textarea visibility when keyboard is open */
    .floating-sheet-mobile textarea:focus,
    .floating-sheet-mobile input:focus {
      position: relative;
      z-index: 1;
      transform: translateZ(0);
    }
    
    /* Fix for Samsung devices */
    .floating-sheet-mobile .scrollable-content {
      min-height: calc(100vh - 60px);
      padding-bottom: 20px;
    }
    
    /* Technician services mobile optimizations */
    .technician-services-container {
      height: calc(var(--vh, 1vh) * 100);
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    .technician-dialog-mobile {
      max-height: calc(var(--vh, 1vh) * 85);
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    .technician-input-mobile {
      min-height: 44px;
      font-size: 16px; /* Prevent zoom on iOS */
    }
    
    .technician-button-mobile {
      min-height: 44px;
      min-width: 44px;
      touch-action: manipulation;
    }
    
    /* Service status buttons mobile optimization */
    .service-status-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      padding: 8px;
    }
    
    .service-status-button {
      min-height: 44px;
      flex: 1;
      min-width: 120px;
      touch-action: manipulation;
    }
    
    /* Service details mobile layout */
    .service-details-mobile {
      padding: 16px;
      max-height: calc(var(--vh, 1vh) * 75);
      overflow-y: auto;
    }
    
    .service-details-mobile h3 {
      font-size: 14px;
      margin-bottom: 8px;
    }
    
    .service-details-mobile p {
      font-size: 14px;
      line-height: 1.4;
    }
  }
  
  /* Additional Android Chrome fixes */
  @supports (env(keyboard-inset-height)) {
    @media screen and (max-width: 768px) {
      .floating-sheet-mobile {
        height: calc(100vh - env(keyboard-inset-height, 0px)) !important;
        max-height: calc(100vh - env(keyboard-inset-height, 0px)) !important;
      }
      
      .floating-sheet-mobile .scrollable-content {
        height: calc(100vh - env(keyboard-inset-height, 0px) - 60px) !important;
      }
    }
  }
}